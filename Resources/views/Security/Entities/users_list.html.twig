{% extends 'RedKiteCmsBundle:Bootstrap:' ~ bootstrap_version ~ '/base.html.twig' %}

{% form_theme form 'RedKiteCmsBundle:Bootstrap:' ~ bootstrap_version ~ '/FormTheme/forms.html.twig' %}

{% block body %}

<div class="panel-container">
    <div id="al_sidebar_left" class="pull-left pages-left panel-column">
        <div class="al_security_list">
            <h2>{{ "security_controller_label_users_management"|trans({}, 'RedKiteCmsBundle', cms_language) }}</h2>
            <table class="table">
                <thead>
                    <th>{{ "security_controller_label_username"|trans({}, 'RedKiteCmsBundle', cms_language) }}</th>
                    <th>{{ "security_controller_label_email"|trans({}, 'RedKiteCmsBundle', cms_language) }}</th>
                </thead>
            {% for user in users %}
                <tr>
                    <td width="60%">{{ user.username }}</td>
                    <td width="40%">{{ user.email }}</td>
                    <td>
                        <a href="#" rel="{{ user.id }}" class="al_edit_user">
                            <button class="btn btn-xs btn-primary" data-user-id="{{ user.id }}">
                                <span class="glyphicon glyphicon-trash"></span>
                            </button>
                        </a>
                    </td>
                    <td>
                        {% set disabled = ' disabled' %}
                        {% set deletable = '' %}
                        {% if(user.id != app.security.getToken().getUser().getPrimaryKey()) %}
                        {% set disabled = '' %}
                        {% set deletable = 'class=al_delete_user ' %}
                        {% endif %}
                        <a href="#" {{ deletable }}rel="{{ user.id }}">
                            <button class="btn btn-xs btn-danger {{ disabled }}" data-user-id="{{ user.id }}">
                                <span class="glyphicon glyphicon-trash"></span>
                            </button>
                        </a>
                    </td>
                </tr>
            {% endfor %}
            </table>
        </div>
    </div>
    <div class="pull-right pages-right panel-column">
        
        <div class="al_security_item">    
            <h2>{{ "security_controller_label_manage_user"|trans({}, 'RedKiteCmsBundle', cms_language) }}</h2>
            <form class="al_security_form">
                <div id="al_user_data">
                    {{ form(form) }}
                </div>
            </form>

            {% if message is defined %}
            <div id="al_message" class="text-info">
                {{ message }}
            </div>
            {% endif %}

            <div class="al_security_commands_box">
                <ul class="{{ list_inline }} pull-right">
                    <li><input type="submit" id="al_save_user" value="{{ "common_label_save"|trans({}, 'RedKiteCmsBundle', cms_language) }}" class="input btn btn-primary" /></li>
                    <li><input type="submit" value="{{ "security_controller_label_users"|trans({}, 'RedKiteCmsBundle', cms_language) }}" class="al_list_users btn btn-info" /></li>
                </ul>
                <div class="clearfix"></div>
            </div>

            <div id="text-error" class="text-error">
                {# for error in errors %}
                <p><strong>{{ error.getMessage() }}</strong></p>
                {% endfor #}
            </div>
        </div>
        
        <div class="al_security_commands_box">
            <ul class="{{ list_inline }} pull-right">
                <li><input type="submit" value="{{ "common_label_new"|trans({}, 'RedKiteCmsBundle', cms_language) }}" class="al_add_user btn btn-primary" /></li>
                <li><input type="submit" value="{{ "security_controller_label_roles"|trans({}, 'RedKiteCmsBundle', cms_language) }}" class="al_list_roles btn btn-info" /></li>
            </ul>
            <div class="clearfix"></div>
        </div>
    </div>
    <div class="clearfix"></div>
</div>


{% endblock %}
